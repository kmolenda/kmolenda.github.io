<!DOCTYPE html><html><head>
      <title>Interfejsy w C# 8</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css">
      
      

      
      
      
      
      
      
      

      <style>
      /**
 * prism.js Github theme based on GitHub's theme.
 * @author Sam Clarke
 */
code[class*="language-"],
pre[class*="language-"] {
  color: #333;
  background: none;
  font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.4;

  -moz-tab-size: 8;
  -o-tab-size: 8;
  tab-size: 8;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

/* Code blocks */
pre[class*="language-"] {
  padding: .8em;
  overflow: auto;
  /* border: 1px solid #ddd; */
  border-radius: 3px;
  /* background: #fff; */
  background: #f5f5f5;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
  padding: .1em;
  border-radius: .3em;
  white-space: normal;
  background: #f5f5f5;
}

.token.comment,
.token.blockquote {
  color: #969896;
}

.token.cdata {
  color: #183691;
}

.token.doctype,
.token.punctuation,
.token.variable,
.token.macro.property {
  color: #333;
}

.token.operator,
.token.important,
.token.keyword,
.token.rule,
.token.builtin {
  color: #a71d5d;
}

.token.string,
.token.url,
.token.regex,
.token.attr-value {
  color: #183691;
}

.token.property,
.token.number,
.token.boolean,
.token.entity,
.token.atrule,
.token.constant,
.token.symbol,
.token.command,
.token.code {
  color: #0086b3;
}

.token.tag,
.token.selector,
.token.prolog {
  color: #63a35c;
}

.token.function,
.token.namespace,
.token.pseudo-element,
.token.class,
.token.class-name,
.token.pseudo-class,
.token.id,
.token.url-reference .token.variable,
.token.attr-name {
  color: #795da3;
}

.token.entity {
  cursor: help;
}

.token.title,
.token.title .token.punctuation {
  font-weight: bold;
  color: #1d3e81;
}

.token.list {
  color: #ed6a43;
}

.token.inserted {
  background-color: #eaffea;
  color: #55a532;
}

.token.deleted {
  background-color: #ffecec;
  color: #bd2c00;
}

.token.bold {
  font-weight: bold;
}

.token.italic {
  font-style: italic;
}


/* JSON */
.language-json .token.property {
  color: #183691;
}

.language-markup .token.tag .token.punctuation {
  color: #333;
}

/* CSS */
code.language-css,
.language-css .token.function {
  color: #0086b3;
}

/* YAML */
.language-yaml .token.atrule {
  color: #63a35c;
}

code.language-yaml {
  color: #183691;
}

/* Ruby */
.language-ruby .token.function {
  color: #333;
}

/* Markdown */
.language-markdown .token.url {
  color: #795da3;
}

/* Makefile */
.language-makefile .token.symbol {
  color: #795da3;
}

.language-makefile .token.variable {
  color: #183691;
}

.language-makefile .token.builtin {
  color: #0086b3;
}

/* Bash */
.language-bash .token.keyword {
  color: #0086b3;
}

/* highlight */
pre[data-line] {
  position: relative;
  padding: 1em 0 1em 3em;
}
pre[data-line] .line-highlight-wrapper {
  position: absolute;
  top: 0;
  left: 0;
  background-color: transparent;
  display: block;
  width: 100%;
}

pre[data-line] .line-highlight {
  position: absolute;
  left: 0;
  right: 0;
  padding: inherit 0;
  margin-top: 1em;
  background: hsla(24, 20%, 50%,.08);
  background: linear-gradient(to right, hsla(24, 20%, 50%,.1) 70%, hsla(24, 20%, 50%,0));
  pointer-events: none;
  line-height: inherit;
  white-space: pre;
}

pre[data-line] .line-highlight:before, 
pre[data-line] .line-highlight[data-end]:after {
  content: attr(data-start);
  position: absolute;
  top: .4em;
  left: .6em;
  min-width: 1em;
  padding: 0 .5em;
  background-color: hsla(24, 20%, 50%,.4);
  color: hsl(24, 20%, 95%);
  font: bold 65%/1.5 sans-serif;
  text-align: center;
  vertical-align: .3em;
  border-radius: 999px;
  text-shadow: none;
  box-shadow: 0 1px white;
}

pre[data-line] .line-highlight[data-end]:after {
  content: attr(data-end);
  top: auto;
  bottom: .4em;
}html body{font-family:"Helvetica Neue",Helvetica,"Segoe UI",Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ul,html body>ol{margin-bottom:16px}html body ul,html body ol{padding-left:2em}html body ul.no-list,html body ol.no-list{padding:0;list-style-type:none}html body ul ul,html body ul ol,html body ol ol,html body ol ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:bold;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:bold}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em !important;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::before,html body code::after{letter-spacing:-0.2em;content:"\00a0"}html body pre>code{padding:0;margin:0;font-size:.85em !important;word-break:normal;white-space:pre;background:transparent;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;font-size:.85em !important;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:before,html body pre tt:before,html body pre code:after,html body pre tt:after{content:normal}html body p,html body blockquote,html body ul,html body ol,html body dl,html body pre{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body pre,html body code{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview .pagebreak,.markdown-preview .newpage{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center !important}.markdown-preview:not([for="preview"]) .code-chunk .btn-group{display:none}.markdown-preview:not([for="preview"]) .code-chunk .status{display:none}.markdown-preview:not([for="preview"]) .code-chunk .output-div{margin-bottom:16px}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0}@media screen and (min-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px + 2em)}}@media screen and (max-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{font-size:14px !important;padding:1em}}@media print{html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,0.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{padding:0 1.6em;margin-top:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc li{margin-bottom:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{list-style-type:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% -  300px);padding:2em calc(50% - 457px -  150px);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */
.markdown-preview.markdown-preview .code-chunk .output-div {
  border-left-style: dotted;
  border-color: gray;
  border-width: 1px;
  font-size: 0.8em;
}
.markdown-preview.markdown-preview .code-chunk .output-div .language-text {
  /* background: #f4fcfd */
  background: black;
  color: yellow;
}

      </style>
    </head>
    <body for="html-export">
      <div class="mume markdown-preview  ">
      <table>
<thead>
<tr>
<th>Krzysztof Molenda</th>
<th>2019-10-20</th>
<th>C#</th>
</tr>
</thead>
<tbody></tbody>
</table>
<h2 class="mume-header" id="interfejsy-w-c-8-nowe-rozdanie">Interfejsy w C# 8 - nowe rozdanie</h2>

<blockquote>
<p>UWAGA: poszukuj&#x105;c informacji na temat domy&#x15B;lnych implementacji metod interfejs&#xF3;w nale&#x17C;y sugerowa&#x107; si&#x119; dat&#x105; publikacji. Wiele artyku&#x142;&#xF3;w dost&#x119;pnych w Internecie traktuje o <em>proposals</em>, kt&#xF3;re zosta&#x142;y zmienione w wersji dystrybucyjnej. Niekt&#xF3;re publikacje mog&#x105; wprowadza&#x107; w b&#x142;&#x105;d!</p>
<p>(<a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/proposals/csharp-8.0/default-interface-methods">https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/proposals/csharp-8.0/default-interface-methods</a>)</p>
</blockquote>
<h2 class="mume-header" id="c-8-domy%C5%9Blna-implementacja-sk%C5%82adnik%C3%B3w-interfejsu">C# 8 - domy&#x15B;lna implementacja sk&#x142;adnik&#xF3;w interfejsu</h2>

<h3 class="mume-header" id="idea">Idea</h3>

<p>W wersji 8 j&#x119;zyka C# (a wcze&#x15B;niej w Java 8) z&#x142;amano podstawow&#x105; zasad&#x119; interfejsu, &#x17C;e wszystkie metody s&#x105; abstrakcyjne (nie ma &#x17C;adnej implementacji). Wprowadzono mo&#x17C;liwo&#x15B;&#x107; <strong><em>domy&#x15B;lnej implementacji metod</em></strong>. Zmiany obowi&#x105;zuj&#x105; od pa&#x17A;dziernika 2019 r.</p>
<p>Przyk&#x142;ad wiod&#x105;cy (klasyczny) - tworzymy aplikacj&#x119;, w kt&#xF3;rej implementujemy mechanizm <em>logowania</em> (rejestrowania) informacji o dzia&#x142;aniu aplikacji. Chcemy mie&#x107; mo&#x17C;liwo&#x15B;&#x107; &quot;prze&#x142;&#x105;czania&quot; strumienia komunikat&#xF3;w mi&#x119;dzy np. konsol&#x119;, plik, a mo&#x17C;e i inne, w tej chwili nie znane miejsce).</p>
<p><strong>Przyk&#x142;ad 1:</strong></p>
<p>Zapisujemy interfejs <code>ILogger</code>:</p>
<div class="code-chunk" data-id="ilogger1" data-cmd="dotnet-script"><div class="input-div"><pre data-role="codeBlock" data-info="csharp {code_chunk_offset=0, cmd=&quot;dotnet-script&quot; id=&quot;ilogger1&quot;}" class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">ILogger</span>
<span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">Info</span><span class="token punctuation">(</span><span class="token keyword">string</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Error</span><span class="token punctuation">(</span><span class="token keyword">string</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre><div class="btn-group"><div class="run-btn btn"><span>&#x25B6;&#xFE0E;</span></div><div class="run-all-btn btn">all</div></div><div class="status">running...</div></div><div class="output-div"></div></div><p>Implementujemy wariant logowania na konsol&#x119;:</p>
<div class="code-chunk" data-id="consolelogger1" data-cmd="dotnet-script"><div class="input-div"><pre data-role="codeBlock" data-info="csharp {code_chunk_offset=1, cmd=&quot;dotnet-script&quot; id=&quot;consolelogger1&quot; continue=&quot;ilogger1&quot;}" class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConsoleLogger</span> <span class="token punctuation">:</span> <span class="token class-name">ILogger</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Error</span><span class="token punctuation">(</span><span class="token keyword">string</span> message<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">&quot;error: &quot;</span> <span class="token operator">+</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Info</span><span class="token punctuation">(</span><span class="token keyword">string</span> message<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">&quot;info: &quot;</span> <span class="token operator">+</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><div class="btn-group"><div class="run-btn btn"><span>&#x25B6;&#xFE0E;</span></div><div class="run-all-btn btn">all</div></div><div class="status">running...</div></div><div class="output-div"></div></div><p>i obiekt klasy <code>ConsoleLogger</code> wykorzystujemy w aplikacji.</p>
<p><!--?xml version="1.0" encoding="UTF-8" standalone="no"?--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" contentscripttype="application/ecmascript" contentstyletype="text/css" height="366px" preserveAspectRatio="none" style="width:552px;height:366px;" version="1.1" viewBox="0 0 552 366" width="552px" zoomAndPan="magnify"><defs><filter height="300%" id="fw1gzl0k915oy" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--MD5=[9c3f40dd4d806dc4ecc502a287ec37eb]
class ILogger--><rect fill="#FEFECE" filter="url(#fw1gzl0k915oy)" height="75.6719" id="ILogger" style="stroke: #A80036; stroke-width: 1.5;" width="141" x="203" y="144"/><ellipse cx="247.75" cy="160" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M248.7031,156.6406 L248.7031,163.2969 L250.4219,163.2969 Q251.0313,163.2969 251.2969,163.5313 Q251.5625,163.7656 251.5625,164.1563 Q251.5625,164.5313 251.2969,164.7656 Q251.0313,165 250.4219,165 L245.2813,165 Q244.6719,165 244.4063,164.7656 Q244.1406,164.5313 244.1406,164.1406 Q244.1406,163.7656 244.4063,163.5313 Q244.6719,163.2969 245.2813,163.2969 L247,163.2969 L247,156.6406 L245.2813,156.6406 Q244.6719,156.6406 244.4063,156.4063 Q244.1406,156.1719 244.1406,155.7813 Q244.1406,155.4063 244.4063,155.1719 Q244.6719,154.9375 245.2813,154.9375 L250.4219,154.9375 Q251.0313,154.9375 251.2969,155.1719 Q251.5625,155.4063 251.5625,155.7813 Q251.5625,156.1719 251.2969,156.4063 Q251.0313,156.6406 250.4219,156.6406 L248.7031,156.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="43" x="268.25" y="164.9102">ILogger</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="204" x2="343" y1="176" y2="176"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="204" x2="343" y1="184" y2="184"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="123" x="209" y="199.4189">void Info(string message)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="129" x="209" y="213.2549">void Error(string message)</text><!--MD5=[ef6e0fb57396685d3eab884a2ccd12ec]
class ConsoleLogger--><rect fill="#FEFECE" filter="url(#fw1gzl0k915oy)" height="75.6719" id="ConsoleLogger" style="stroke: #A80036; stroke-width: 1.5;" width="155" x="6" y="280"/><ellipse cx="37.65" cy="296" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M40.4156,291.875 Q40.5719,291.6563 40.7594,291.5469 Q40.9469,291.4375 41.1656,291.4375 Q41.5406,291.4375 41.775,291.7031 Q42.0094,291.9531 42.0094,292.5625 L42.0094,294.0156 Q42.0094,294.625 41.775,294.8906 Q41.5406,295.1563 41.1656,295.1563 Q40.8219,295.1563 40.6188,294.9531 Q40.4156,294.7656 40.3063,294.25 Q40.2594,293.8906 40.0719,293.7031 Q39.7438,293.3281 39.1344,293.1094 Q38.525,292.8906 37.9,292.8906 Q37.1344,292.8906 36.4938,293.2188 Q35.8688,293.5469 35.3688,294.2969 Q34.8844,295.0469 34.8844,296.0781 L34.8844,297.1719 Q34.8844,298.4063 35.775,299.2344 Q36.6656,300.0469 38.2594,300.0469 Q39.1969,300.0469 39.8531,299.7969 Q40.2438,299.6406 40.6656,299.2031 Q40.9313,298.9375 41.0719,298.8594 Q41.2281,298.7813 41.4313,298.7813 Q41.7594,298.7813 42.0094,299.0469 Q42.275,299.2969 42.275,299.6406 Q42.275,299.9844 41.9313,300.3906 Q41.4313,300.9688 40.6344,301.2969 Q39.5563,301.75 38.2594,301.75 Q36.7438,301.75 35.5406,301.125 Q34.5563,300.625 33.8688,299.5625 Q33.1813,298.4844 33.1813,297.2031 L33.1813,296.0469 Q33.1813,294.7188 33.7906,293.5781 Q34.4156,292.4219 35.5094,291.8125 Q36.6031,291.1875 37.8375,291.1875 Q38.5719,291.1875 39.2125,291.3594 Q39.8688,291.5156 40.4156,291.875 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="86" x="55.35" y="300.9102">ConsoleLogger</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="7" x2="160" y1="312" y2="312"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="7" x2="160" y1="320" y2="320"/><ellipse cx="17" cy="331" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="129" x="26" y="335.4189">void Error(string message)</text><ellipse cx="17" cy="344.8359" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="123" x="26" y="349.2549">void Info(string message)</text><!--MD5=[27a2caf253a0da4852d53bf0c6340241]
class FileLogger--><rect fill="#FEFECE" filter="url(#fw1gzl0k915oy)" height="75.6719" id="FileLogger" style="stroke: #A80036; stroke-width: 1.5;" width="155" x="196" y="280"/><ellipse cx="239.8" cy="296" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M242.5656,291.875 Q242.7219,291.6563 242.9094,291.5469 Q243.0969,291.4375 243.3156,291.4375 Q243.6906,291.4375 243.925,291.7031 Q244.1594,291.9531 244.1594,292.5625 L244.1594,294.0156 Q244.1594,294.625 243.925,294.8906 Q243.6906,295.1563 243.3156,295.1563 Q242.9719,295.1563 242.7688,294.9531 Q242.5656,294.7656 242.4563,294.25 Q242.4094,293.8906 242.2219,293.7031 Q241.8938,293.3281 241.2844,293.1094 Q240.675,292.8906 240.05,292.8906 Q239.2844,292.8906 238.6438,293.2188 Q238.0188,293.5469 237.5188,294.2969 Q237.0344,295.0469 237.0344,296.0781 L237.0344,297.1719 Q237.0344,298.4063 237.925,299.2344 Q238.8156,300.0469 240.4094,300.0469 Q241.3469,300.0469 242.0031,299.7969 Q242.3938,299.6406 242.8156,299.2031 Q243.0813,298.9375 243.2219,298.8594 Q243.3781,298.7813 243.5813,298.7813 Q243.9094,298.7813 244.1594,299.0469 Q244.425,299.2969 244.425,299.6406 Q244.425,299.9844 244.0813,300.3906 Q243.5813,300.9688 242.7844,301.2969 Q241.7063,301.75 240.4094,301.75 Q238.8938,301.75 237.6906,301.125 Q236.7063,300.625 236.0188,299.5625 Q235.3313,298.4844 235.3313,297.2031 L235.3313,296.0469 Q235.3313,294.7188 235.9406,293.5781 Q236.5656,292.4219 237.6594,291.8125 Q238.7531,291.1875 239.9875,291.1875 Q240.7219,291.1875 241.3625,291.3594 Q242.0188,291.5156 242.5656,291.875 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="59" x="260.2" y="300.9102">FileLogger</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="197" x2="350" y1="312" y2="312"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="197" x2="350" y1="320" y2="320"/><ellipse cx="207" cy="331" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="129" x="216" y="335.4189">void Error(string message)</text><ellipse cx="207" cy="344.8359" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="123" x="216" y="349.2549">void Info(string message)</text><!--MD5=[466301677e557d5dbff0d0dfe9d5267a]
class DBLogger--><rect fill="#FEFECE" filter="url(#fw1gzl0k915oy)" height="75.6719" id="DBLogger" style="stroke: #A80036; stroke-width: 1.5;" width="155" x="386" y="280"/><ellipse cx="431.25" cy="296" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M434.0156,291.875 Q434.1719,291.6563 434.3594,291.5469 Q434.5469,291.4375 434.7656,291.4375 Q435.1406,291.4375 435.375,291.7031 Q435.6094,291.9531 435.6094,292.5625 L435.6094,294.0156 Q435.6094,294.625 435.375,294.8906 Q435.1406,295.1563 434.7656,295.1563 Q434.4219,295.1563 434.2188,294.9531 Q434.0156,294.7656 433.9063,294.25 Q433.8594,293.8906 433.6719,293.7031 Q433.3438,293.3281 432.7344,293.1094 Q432.125,292.8906 431.5,292.8906 Q430.7344,292.8906 430.0938,293.2188 Q429.4688,293.5469 428.9688,294.2969 Q428.4844,295.0469 428.4844,296.0781 L428.4844,297.1719 Q428.4844,298.4063 429.375,299.2344 Q430.2656,300.0469 431.8594,300.0469 Q432.7969,300.0469 433.4531,299.7969 Q433.8438,299.6406 434.2656,299.2031 Q434.5313,298.9375 434.6719,298.8594 Q434.8281,298.7813 435.0313,298.7813 Q435.3594,298.7813 435.6094,299.0469 Q435.875,299.2969 435.875,299.6406 Q435.875,299.9844 435.5313,300.3906 Q435.0313,300.9688 434.2344,301.2969 Q433.1563,301.75 431.8594,301.75 Q430.3438,301.75 429.1406,301.125 Q428.1563,300.625 427.4688,299.5625 Q426.7813,298.4844 426.7813,297.2031 L426.7813,296.0469 Q426.7813,294.7188 427.3906,293.5781 Q428.0156,292.4219 429.1094,291.8125 Q430.2031,291.1875 431.4375,291.1875 Q432.1719,291.1875 432.8125,291.3594 Q433.4688,291.5156 434.0156,291.875 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="56" x="451.75" y="300.9102">DBLogger</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="387" x2="540" y1="312" y2="312"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="387" x2="540" y1="320" y2="320"/><ellipse cx="397" cy="331" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="129" x="406" y="335.4189">void Error(string message)</text><ellipse cx="397" cy="344.8359" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="123" x="406" y="349.2549">void Info(string message)</text><!--MD5=[b3db53f20b85fed898fb0d848cf36d50]
class MyApplication--><rect fill="#FEFECE" filter="url(#fw1gzl0k915oy)" height="75.6719" id="MyApplication" style="stroke: #A80036; stroke-width: 1.5;" width="231" x="158" y="8"/><ellipse cx="232.25" cy="24" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M235.0156,19.875 Q235.1719,19.6563 235.3594,19.5469 Q235.5469,19.4375 235.7656,19.4375 Q236.1406,19.4375 236.375,19.7031 Q236.6094,19.9531 236.6094,20.5625 L236.6094,22.0156 Q236.6094,22.625 236.375,22.8906 Q236.1406,23.1563 235.7656,23.1563 Q235.4219,23.1563 235.2188,22.9531 Q235.0156,22.7656 234.9063,22.25 Q234.8594,21.8906 234.6719,21.7031 Q234.3438,21.3281 233.7344,21.1094 Q233.125,20.8906 232.5,20.8906 Q231.7344,20.8906 231.0938,21.2188 Q230.4688,21.5469 229.9688,22.2969 Q229.4844,23.0469 229.4844,24.0781 L229.4844,25.1719 Q229.4844,26.4063 230.375,27.2344 Q231.2656,28.0469 232.8594,28.0469 Q233.7969,28.0469 234.4531,27.7969 Q234.8438,27.6406 235.2656,27.2031 Q235.5313,26.9375 235.6719,26.8594 Q235.8281,26.7813 236.0313,26.7813 Q236.3594,26.7813 236.6094,27.0469 Q236.875,27.2969 236.875,27.6406 Q236.875,27.9844 236.5313,28.3906 Q236.0313,28.9688 235.2344,29.2969 Q234.1563,29.75 232.8594,29.75 Q231.3438,29.75 230.1406,29.125 Q229.1563,28.625 228.4688,27.5625 Q227.7813,26.4844 227.7813,25.2031 L227.7813,24.0469 Q227.7813,22.7188 228.3906,21.5781 Q229.0156,20.4219 230.1094,19.8125 Q231.2031,19.1875 232.4375,19.1875 Q233.1719,19.1875 233.8125,19.3594 Q234.4688,19.5156 235.0156,19.875 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="74" x="252.75" y="28.9102">MyApplication</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="159" x2="388" y1="40" y2="40"/><ellipse cx="169" cy="51" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="102" x="178" y="55.4189">ILogger Logger {get;}</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="159" x2="388" y1="61.8359" y2="61.8359"/><ellipse cx="169" cy="72.8359" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="205" x="178" y="77.2549">MyApplication(ILogger logger) &#xAB;construct&#xBB;</text><!--MD5=[97632770e9f369e6fca08c9c011a0d3a]
reverse link ILogger to ConsoleLogger--><path d="M204.18,231.889 C181.766,247.696 157.291,264.9581 136.276,279.7792 " fill="none" id="ILogger&lt;-ConsoleLogger" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="none" points="200.448,225.955,220.827,220.149,208.517,237.396,200.448,225.955" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[e7f0d8031c783e33a37744ba2b196af6]
reverse link ILogger to FileLogger--><path d="M273.5,240.535 C273.5,253.86 273.5,267.6949 273.5,279.8737 " fill="none" id="ILogger&lt;-FileLogger" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="none" points="266.5,240.327,273.5,220.326,280.5,240.326,266.5,240.327" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[7b6c4e7c23f2b3d64db9bc298eb0214e]
reverse link ILogger to DBLogger--><path d="M342.82,231.889 C365.234,247.696 389.709,264.9581 410.724,279.7792 " fill="none" id="ILogger&lt;-DBLogger" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="none" points="338.483,237.396,326.173,220.149,346.552,225.955,338.483,237.396" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[24c14a998ec14925267c4e26e5a13361]
reverse link MyApplication to ILogger--><path d="M273.5,97.458 C273.5,112.866 273.5,129.52 273.5,143.874 " fill="none" id="MyApplication&lt;-ILogger" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="273.5,84.326,269.5,90.326,273.5,96.326,277.5,90.326,273.5,84.326" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[11a07050f4c5a582456859db566eb01c]
@startuml
interface ILogger {
    void Info(string message)
    void Error(string message)
}

class ConsoleLogger {
    + void Error(string message)
    + void Info(string message)
}

class FileLogger {
    + void Error(string message)
    + void Info(string message)
}

class DBLogger {
    + void Error(string message)
    + void Info(string message)
}

class MyApplication {
    + ILogger Logger {get;}
    + MyApplication(ILogger logger) <<construct>>

}

ILogger <|.. ConsoleLogger
ILogger <|.. FileLogger
ILogger <|.. DBLogger
MyApplication *- - ILogger

@enduml

PlantUML version 1.2019.11(Sun Sep 22 12:02:15 CEST 2019)
(MIT source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.2+9
Operating System: Windows 10
Default Encoding: Cp1250
Language: pl
Country: PL
--></g></svg></p><p>Wyobra&#x17A;my sobie teraz, &#x17C;e interfejs <code>ILogger</code> z jakich&#x15B; powod&#xF3;w zosta&#x142; zmodyfikowany, poprzez dodanie deklaracji nowej metody:</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">ILogger</span>
<span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">Info</span><span class="token punctuation">(</span><span class="token keyword">string</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Error</span><span class="token punctuation">(</span><span class="token keyword">string</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// New method</span>
    <span class="token keyword">void</span> <span class="token function">Warn</span><span class="token punctuation">(</span><span class="token keyword">string</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre><p>Pr&#xF3;ba kompilacji (C# 7.x i wcze&#x15B;niejsze) spowoduje b&#x142;&#x119;dy - brak implementacji metody <code>Warn</code> w klasach implementuj&#x105;cych interfejs <code>ILogger</code>.</p>
<p>W C# 8 (<code>.Net Core 3</code>, <code>.Net Framework 4.8</code>, <code>.Net Standard 2.1</code>) umo&#x17C;liwiono <strong>domy&#x15B;ln&#x105; implementacj&#x119;</strong> metody interfejsu - czyli zawarcie kodu, kt&#xF3;ry zostanie wykonany w sytuacji nie przes&#x142;oni&#x119;cia metody w klasach implementuj&#x105;cych.</p>
<hr>
<p><strong>Przyk&#x142;ad 2:</strong></p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp"><span class="token comment">// C# 8</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">ILogger</span>
<span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">Info</span><span class="token punctuation">(</span><span class="token keyword">string</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Error</span><span class="token punctuation">(</span><span class="token keyword">string</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// New method with implementation (C# 8)</span>
    <span class="token keyword">void</span> <span class="token function">Warn</span><span class="token punctuation">(</span><span class="token keyword">string</span> message<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Debug<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">&quot;warn default: &quot;</span> <span class="token operator">+</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OldConsoleLogger</span> <span class="token punctuation">:</span> <span class="token class-name">ILogger</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Error</span><span class="token punctuation">(</span><span class="token keyword">string</span> message<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">&quot;error: &quot;</span> <span class="token operator">+</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Info</span><span class="token punctuation">(</span><span class="token keyword">string</span> message<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">&quot;info: &quot;</span> <span class="token operator">+</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">NewConsoleLogger</span> <span class="token punctuation">:</span> <span class="token class-name">OldConsoleLogger</span><span class="token punctuation">,</span> ILogger
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Warn</span><span class="token punctuation">(</span><span class="token keyword">string</span> message<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">&quot;warn: &quot;</span> <span class="token operator">+</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// ====</span>

<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token preprocessor property">#<span class="token directive keyword">if</span> (NET48 || NETSTANDARD2_1 || NETCOREAPP3_0)</span>
    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">&quot;C# 8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token preprocessor property">#<span class="token directive keyword">endif</span></span>
    <span class="token class-name">ILogger</span> logger <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">OldConsoleLogger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    logger<span class="token punctuation">.</span><span class="token function">Warn</span><span class="token punctuation">(</span><span class="token string">&quot;ostrze&#x17C;enie od logger&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">ILogger</span> logger1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NewConsoleLogger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    logger1<span class="token punctuation">.</span><span class="token function">Warn</span><span class="token punctuation">(</span><span class="token string">&quot;ostrze&#x17C;enie od logger1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">OldConsoleLogger</span> logger2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">OldConsoleLogger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//logger2.Warn(&quot;ostrze&#x17C;enie od logger2&quot;); //compilation error, klasa ConsoleLogger nie implementuje `Warn`</span>
    <span class="token punctuation">(</span><span class="token punctuation">(</span>ILogger<span class="token punctuation">)</span>logger2<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Warn</span><span class="token punctuation">(</span><span class="token string">&quot;ostrze&#x17C;enie od logger2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// konieczne rzutowanie na interfejs</span>
    <span class="token class-name">NewConsoleLogger</span> logger3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NewConsoleLogger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    logger3<span class="token punctuation">.</span><span class="token function">Warn</span><span class="token punctuation">(</span><span class="token string">&quot;ostrze&#x17C;enie od logger3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre><pre data-role="codeBlock" data-info="console" class="language-console"><code>C# 8
warn default: ostrze&#x17C;enie od logger
warn: ostrze&#x17C;enie od logger1
warn default: ostrze&#x17C;enie od logger2
warn: ostrze&#x17C;enie od logger3
</code></pre><p>Wprowadzenie domy&#x15B;lnej implementacji metod w interfejsie - z technicznego punktu widzenia - rozszerza funkcjonalno&#x15B;&#x107; tej konstrukcji j&#x119;zyka.</p>
<p>Zwr&#xF3;&#x107;my uwag&#x119; na kilka szczeg&#xF3;&#x142;&#xF3;w:</p>
<ul>
<li>
<p>dodanie nowej metody do interfejsu, wraz z jej domy&#x15B;ln&#x105; implementacj&#x105;, nie narusza poprawno&#x15B;ci istniej&#x105;cego kodu,</p>
</li>
<li>
<p>mo&#x17C;emy korzysta&#x107; z nowej funkcjonalno&#x15B;ci, o ile zmienna odwo&#x142;uje si&#x119; do interfejsu:</p>
<pre data-role="codeBlock" data-info="csharp {highlight=1}" class="language-csharp" data-line="1"><span class="token class-name">ILogger</span> logger <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">OldConsoleLogger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
logger<span class="token punctuation">.</span><span class="token function">Warn</span><span class="token punctuation">(</span><span class="token string">&quot;ostrze&#x17C;enie od logger&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<div class="line-highlight-wrapper"><div aria-hidden="true" class="line-highlight" data-range="1" data-start="1">
</div></div></pre><p>Klasa <code>OldConsoleLogger</code> nie implementuje nowej metody <code>Warn</code>, ale mo&#x17C;emy skorzysta&#x107; z implementacji domy&#x15B;lnej,</p>
</li>
<li>
<p>je&#x15B;li jednak zmienna odwo&#x142;uje si&#x119; do klasy (1), a klasa nie implementuje metody domy&#x15B;lnej, pojawi si&#x119; b&#x142;&#x105;d kompilacji (2).</p>
<pre data-role="codeBlock" data-info="csharp {highlight=[1,2,3]}" class="language-csharp" data-line="1,2,3"><span class="token class-name">OldConsoleLogger</span> logger2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">OldConsoleLogger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
logger2<span class="token punctuation">.</span><span class="token function">Warn</span><span class="token punctuation">(</span><span class="token string">&quot;ostrze&#x17C;enie od logger2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//compilation error, klasa ConsoleLogger nie implementuje `Warn`</span>
<span class="token punctuation">(</span><span class="token punctuation">(</span>ILogger<span class="token punctuation">)</span>logger2<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Warn</span><span class="token punctuation">(</span><span class="token string">&quot;ostrze&#x17C;enie od logger2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// konieczne rzutowanie na interfejs</span>
<div class="line-highlight-wrapper"><div aria-hidden="true" class="line-highlight" data-range="1" data-start="1">
</div></div><div class="line-highlight-wrapper">
<div aria-hidden="true" class="line-highlight" data-range="2" data-start="2">
</div></div><div class="line-highlight-wrapper">

<div aria-hidden="true" class="line-highlight" data-range="3" data-start="3">
</div></div></pre><p>Aby skorzysta&#x107; z domy&#x15B;lnej implementacji, <strong>musimy rzutowa&#x107; na interfejs</strong> (3).</p>
</li>
<li>
<p>w ka&#x17C;dym przypadku, je&#x15B;li zaimplementujemy metod&#x119;, mo&#x17C;emy odwo&#x142;ywa&#x107; si&#x119; do niej bezpo&#x15B;rednio (bez rzutowania).</p>
<pre data-role="codeBlock" data-info="csharp {highlight=[2,5]}" class="language-csharp" data-line="2,5"><span class="token class-name">ILogger</span> logger1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NewConsoleLogger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
logger1<span class="token punctuation">.</span><span class="token function">Warn</span><span class="token punctuation">(</span><span class="token string">&quot;ostrze&#x17C;enie od logger1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">NewConsoleLogger</span> logger3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NewConsoleLogger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
logger3<span class="token punctuation">.</span><span class="token function">Warn</span><span class="token punctuation">(</span><span class="token string">&quot;ostrze&#x17C;enie od logger3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<div class="line-highlight-wrapper">
<div aria-hidden="true" class="line-highlight" data-range="2" data-start="2">
</div></div><div class="line-highlight-wrapper">



<div aria-hidden="true" class="line-highlight" data-range="5" data-start="5">
</div></div></pre></li>
<li>
<p><strong>Zapami&#x119;taj</strong>: klasa implementuj&#x105;ca interfejs <strong>nie dziedziczy</strong> metody z domy&#x15B;ln&#x105; implementacj&#x105;, ale mo&#x17C;e z niej skorzysta&#x107; - odwo&#x142;uj&#x105;c si&#x119; do tej metody poprzez referencj&#x119; do interfejsu.</p>
</li>
</ul>
<p>Przeciwnicy tego rozwi&#x105;zania twierdz&#x105; jednak, &#x17C;e zak&#x142;&#xF3;ca ono planowan&#x105; architektur&#x119; i funkcjonalno&#x15B;&#x107; hierarchii klas (ju&#x17C; po zaprojektowaniu hierarchii interfejs&#xF3;w i klas mo&#x17C;na zmieni&#x107;/uzupe&#x142;ni&#x107; za&#x142;o&#x17C;enia - bez negatywnych implikacji). Jest - swego rodzaju - wstrzykiwaniem nowej funkcjonalno&#x15B;ci do istniej&#x105;cego kodu. Zwolennicy s&#x105; za&#x15B; zachwyceni.</p>
<blockquote>
<p>Default implementations may actually turn out to be very useful. Suppose we have public library used by other developers all around the world. We want to release new version where we have improved some interfaces and &#x2013; of course &#x2013; we want to avoid breaking changes. As we have been on interfaces with our library for God knows how long then we cannot just jump between interfaces and abstract classes like we wish. If we add new members to our interfaces then we can define implementations so programs using previous versions of our libraries can use also new versions without changes to their codebase. I guess for many developers it makes life way easier.</p>
</blockquote>
<p>W tym momencie interfejsy &quot;zbli&#x17C;aj&#x105; si&#x119;&quot; funkcjonalno&#x15B;ci&#x105; do klas abstrakcyjnych (r&#xF3;wnie&#x17C; poprzez modyfikacje sk&#x142;adni). Jednocze&#x15B;nie C# 8 zmierza w kierunku j&#x119;zyk&#xF3;w funkcyjnych.</p>
<hr>
<p>Rozbudujmy (w duchu j&#x119;zyka C# 8) poprzedni przyk&#x142;ad.</p>
<p><strong>Przyk&#x142;ad 3:</strong></p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp"><span class="token comment">// C# 8</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">ILogger</span>
<span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">Write</span><span class="token punctuation">(</span><span class="token keyword">string</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// obowi&#x105;zek implementacji</span>
    <span class="token keyword">void</span> <span class="token function">Info</span><span class="token punctuation">(</span><span class="token keyword">string</span> message<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">&quot;info: &quot;</span> <span class="token operator">+</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Error</span><span class="token punctuation">(</span><span class="token keyword">string</span> message<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">&quot;error: &quot;</span> <span class="token operator">+</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Warn</span><span class="token punctuation">(</span><span class="token keyword">string</span> message<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">&quot;warning: &quot;</span> <span class="token operator">+</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConsoleLogger</span> <span class="token punctuation">:</span> <span class="token class-name">ILogger</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Write</span><span class="token punctuation">(</span><span class="token keyword">string</span> message<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConsoleLogger1</span> <span class="token punctuation">:</span> <span class="token class-name">ILogger</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Write</span><span class="token punctuation">(</span><span class="token keyword">string</span> message<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Warn</span><span class="token punctuation">(</span><span class="token keyword">string</span> message<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">&quot;debug warning: &quot;</span> <span class="token operator">+</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// ====</span>

<span class="token comment">//static void Main()</span>
<span class="token punctuation">{</span>
    <span class="token class-name">ILogger</span> logger <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConsoleLogger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    logger<span class="token punctuation">.</span><span class="token function">Warn</span><span class="token punctuation">(</span><span class="token string">&quot;ostrze&#x17C;enie&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">ILogger</span> logger1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConsoleLogger1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    logger1<span class="token punctuation">.</span><span class="token function">Warn</span><span class="token punctuation">(</span><span class="token string">&quot;ostrze&#x17C;enie&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre><pre data-role="codeBlock" data-info="console" class="language-console"><code>warning: ostrze&#x17C;enie
debug warning: ostrze&#x17C;enie
</code></pre><p>W powy&#x17C;szym przyk&#x142;adzie, odpowiednio projektuj&#x105;c interfejs, unikamy powtarzania kodu (w klasach implementuj&#x105;cych wymagana jest jedynie implementacja metody <code>Write()</code>, nikt nie zabrania ale i nie nakazuje implementowania pozosta&#x142;ych metod).</p>
<p>Ten sam efekt osi&#x105;gn&#x119;liby&#x15B;my za pomoc&#x105; klasy abstrakcyjnej (ale pami&#x119;tajmy - klasa dziedziczy tylko z jednej klasy, za&#x15B; implementowa&#x107; mo&#x17C;e wiele interfejs&#xF3;w).</p>
<h3 class="mume-header" id="konsekwencje">Konsekwencje</h3>

<p><a href="https://www.talkingdotnet.com/default-implementations-in-interfaces-in-c-sharp-8/">https://www.talkingdotnet.com/default-implementations-in-interfaces-in-c-sharp-8/</a></p>
<p>Z&#x142;amanie fundamentalnej zasady deklarowania i dzia&#x142;ania interfejsu niesie ze sob&#x105; kolejne konsekwencje.</p>
<h4 class="mume-header" id="sk%C5%82adniki-prywatne-interfejs%C3%B3w">Sk&#x142;adniki prywatne interfejs&#xF3;w</h4>

<p>Skoro w interfejsie mo&#x17C;emy definiowa&#x107; kod, to - chocia&#x17C;by ze wzgl&#x119;d&#xF3;w praktycznych - przyda&#x142;oby si&#x119; umieszczenie kodu prywatnego. <strong>W C# 8 interfejsy mog&#x105; mie&#x107; sk&#x142;adniki prywatne</strong>, do ich w&#x142;asnego u&#x17C;ytku:</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">ILogger</span>
<span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">Write</span><span class="token punctuation">(</span><span class="token keyword">string</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Info</span><span class="token punctuation">(</span><span class="token keyword">string</span> message<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">&quot;info: &quot;</span> <span class="token operator">+</span> <span class="token function">clean</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Error</span><span class="token punctuation">(</span><span class="token keyword">string</span> message<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">&quot;error: &quot;</span> <span class="token operator">+</span> <span class="token function">clean</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Warn</span><span class="token punctuation">(</span><span class="token keyword">string</span> message<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">&quot;warning: &quot;</span> <span class="token operator">+</span> <span class="token function">clean</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token keyword">string</span> <span class="token function">clean</span><span class="token punctuation">(</span><span class="token keyword">string</span> message<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        message<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> DateTime<span class="token punctuation">.</span>Now <span class="token operator">+</span> <span class="token string">&quot;: &quot;</span> <span class="token operator">+</span> message<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">const</span> <span class="token keyword">string</span> version <span class="token operator">=</span> <span class="token string">&quot;0.1.1&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre><blockquote>
<p>UWAGA: w interfejsie <strong>nie mo&#x17C;na definiowa&#x107; zmiennych instancji</strong>. Mo&#x17C;na za to definiowa&#x107; sta&#x142;e.</p>
</blockquote>
<h4 class="mume-header" id="sk%C5%82adniki-statyczne-interfejs%C3%B3w">Sk&#x142;adniki statyczne interfejs&#xF3;w</h4>

<p>Interfejsy <strong>mog&#x105; definiowa&#x107; sk&#x142;adniki statyczne</strong>, mog&#x105; to by&#x107; metody, ale<br>
r&#xF3;wnie&#x17C; pola. Mog&#x105; by&#x107; one u&#x17C;yte do parametryzacji domy&#x15B;lnej implementacji.</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">ILogger2</span>
<span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">Write</span><span class="token punctuation">(</span><span class="token keyword">string</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Info</span><span class="token punctuation">(</span><span class="token keyword">string</span> message<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">&quot;info: &quot;</span> <span class="token operator">+</span> <span class="token function">clean</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> count<span class="token operator">++</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">Error</span><span class="token punctuation">(</span><span class="token keyword">string</span> message<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">&quot;error: &quot;</span> <span class="token operator">+</span> <span class="token function">clean</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> count<span class="token operator">++</span><span class="token punctuation">;</span><span class="token punctuation">}</span> 
    <span class="token keyword">void</span> <span class="token function">Warn</span><span class="token punctuation">(</span><span class="token keyword">string</span> message<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">&quot;warning: &quot;</span> <span class="token operator">+</span> <span class="token function">clean</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> count<span class="token operator">++</span><span class="token punctuation">;</span><span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">string</span> <span class="token function">clean</span><span class="token punctuation">(</span><span class="token keyword">string</span> message<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        message<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> DateTime<span class="token punctuation">.</span>Now <span class="token operator">+</span> <span class="token string">&quot;: &quot;</span> <span class="token operator">+</span> message<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">const</span> <span class="token keyword">string</span> version <span class="token operator">=</span> <span class="token string">&quot;0.1.1&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">int</span> CountMessages <span class="token operator">=&gt;</span> count<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre><p>W powy&#x17C;szej implementacji (naci&#x105;ganej na si&#x142;&#x119;) wymuszamy implementacj&#x119; lub akceptacj&#x119; metody <code>CountMessages</code>, kt&#xF3;ra zlicza liczb&#x119; logowanych komunikat&#xF3;w. Sk&#x142;adniki statyczne s&#x105; szczeg&#xF3;&#x142;em implementacji, ale by&#x107; mo&#x17C;e w niekt&#xF3;rych sytuacjach s&#x105; konieczne. Pierwotne za&#x142;o&#x17C;enie, &#x17C;e interfejsy &quot;pracuj&#x105; na rzecz instancji&quot; zostaje z&#x142;amane.</p>
<h4 class="mume-header" id="sk%C5%82adniki-publiczne-interfejs%C3%B3w">Sk&#x142;adniki publiczne interfejs&#xF3;w</h4>

<p>W C# 8 mo&#x17C;na doda&#x107; specyfikator dost&#x119;pu <code>public</code> w deklaracji sk&#x142;adnik&#xF3;w (w C# 7 kompilator wskazuje b&#x142;&#x105;d). Jego u&#x17C;ycie nie ma &#x17C;adnych konsekwencji.</p>
<p>Mo&#x17C;na r&#xF3;wnie&#x17C; deklarowa&#x107; sk&#x142;adniki <code>internal</code> oraz <code>protected</code>.</p>
<h4 class="mume-header" id="hierarchie-interfejs%C3%B3w">Hierarchie interfejs&#xF3;w</h4>

<p>Interfejsy mog&#x105; budowa&#x107; swoje hierarchie dziedziczenia (odizolowane od hierarchii klas). Skoro pojawiaj&#x105; si&#x119; implementacje, to pojawia si&#x119; r&#xF3;wnie&#x17C; ich przes&#x142;anianie.</p>
<p>We wcze&#x15B;niejszych wersjach C# metody interfejsu by&#x142;y abstrakcyjne (i wirtualne). R&#xF3;wnie&#x17C; teraz to si&#x119; nie zmienia (dla metod bez modyfikatora). Mo&#x17C;emy jednak dodawa&#x107; modyfikatory <code>abstract</code> oraz <code>virtual</code> do sygnatur metod.</p>
<p>Drobne r&#xF3;&#x17C;nice pojawiaj&#x105; si&#x119; w kontek&#x15B;cie hierarchii interfejs&#xF3;w.</p>
<p>Modyfikator <code>abstract</code>: nie wnosi &#x17C;adnej r&#xF3;&#x17C;nicy, metoda wymaga implementacji w klasie implementuj&#x105;cej interfejs. Domy&#x15B;lnie, metody interfejsu bez implementacji domy&#x15B;lnej s&#x105; <code>abstract</code>.</p>
<p>Modyfikator <code>virtual</code>: domy&#x15B;lnie metody interfejsu z implementacj&#x105; s&#x105; <code>virtual</code>, o ile nie zosta&#x142;y one oznaczone jako <code>private</code> lub <code>sealed</code>. Mo&#x17C;na ten fakt zaznaczy&#x107; modyfikatorem (ale nie jest to wymagane).</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">ILogger2</span>
<span class="token punctuation">{</span>
    <span class="token keyword">abstract</span> <span class="token keyword">void</span> <span class="token function">Write</span><span class="token punctuation">(</span><span class="token keyword">string</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// abstract nie wymagane</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">Info</span><span class="token punctuation">(</span><span class="token keyword">string</span> message<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">&quot;info: &quot;</span> <span class="token operator">+</span> <span class="token function">clean</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> count<span class="token operator">++</span><span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token comment">// virtual ne wymagane</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">Error</span><span class="token punctuation">(</span><span class="token keyword">string</span> message<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">&quot;error: &quot;</span> <span class="token operator">+</span> <span class="token function">clean</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> count<span class="token operator">++</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">Warn</span><span class="token punctuation">(</span><span class="token keyword">string</span> message<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">&quot;warning: &quot;</span> <span class="token operator">+</span> <span class="token function">clean</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> count<span class="token operator">++</span><span class="token punctuation">;</span><span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">string</span> <span class="token function">clean</span><span class="token punctuation">(</span><span class="token keyword">string</span> message<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        message<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> DateTime<span class="token punctuation">.</span>Now <span class="token operator">+</span> <span class="token string">&quot;: &quot;</span> <span class="token operator">+</span> message<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">const</span> <span class="token keyword">string</span> version <span class="token operator">=</span> <span class="token string">&quot;0.1.1&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">int</span> CountMessages <span class="token operator">=&gt;</span> count<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre><p>Oczywi&#x15B;cie u&#x17C;ycie <code>virtual</code> czy <code>abstract</code>w odniesieniu do metody prywatnej nie ma sensu!</p>
<p>Zasady budowania hierarchii interfejs&#xF3;w i dziedziczenia domy&#x15B;lnych implementacji metod s&#x105; takie same, jak dla hierarchii klas. Mo&#x17C;e z wyj&#x105;tkiem s&#x142;owa kluczowego <code>override</code>, kt&#xF3;rego u&#x17C;ycie jest zabronione (metody przes&#x142;aniane bez modyfikatora <code>override</code> lub ukrywane z modyfikatorem <code>new</code> - pod gro&#x17A;b&#x105; ostrze&#x17C;e&#x144;).</p>
<p>Modyfikator <code>protected</code> ogranicza widoczno&#x15B;&#x107; metod do odpowiedniej ga&#x142;&#x119;zi w hierarchii interfejs&#xF3;w.</p>
<p><strong>Diamond problem:</strong></p>
<p>Wprowadzenie mo&#x17C;liwo&#x15B;ci implementacji metod w interfejsach wraca nas do problemu komplikacji z wielodziedziczeniem.</p>
<p><!--?xml version="1.0" encoding="UTF-8" standalone="no"?--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" contentscripttype="application/ecmascript" contentstyletype="text/css" height="324px" preserveAspectRatio="none" style="width:339px;height:324px;" version="1.1" viewBox="0 0 339 324" width="339px" zoomAndPan="magnify"><defs><filter height="300%" id="fo14e3pkjft7r" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--MD5=[9eb45dd25a30fc27f30a6be8ec5aab51]
class IDevice--><rect fill="#FEFECE" filter="url(#fo14e3pkjft7r)" height="61.8359" id="IDevice" style="stroke: #A80036; stroke-width: 1.5;" width="74" x="163.5" y="8"/><ellipse cx="178.5" cy="24" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M179.4531,20.6406 L179.4531,27.2969 L181.1719,27.2969 Q181.7813,27.2969 182.0469,27.5313 Q182.3125,27.7656 182.3125,28.1563 Q182.3125,28.5313 182.0469,28.7656 Q181.7813,29 181.1719,29 L176.0313,29 Q175.4219,29 175.1563,28.7656 Q174.8906,28.5313 174.8906,28.1406 Q174.8906,27.7656 175.1563,27.5313 Q175.4219,27.2969 176.0313,27.2969 L177.75,27.2969 L177.75,20.6406 L176.0313,20.6406 Q175.4219,20.6406 175.1563,20.4063 Q174.8906,20.1719 174.8906,19.7813 Q174.8906,19.4063 175.1563,19.1719 Q175.4219,18.9375 176.0313,18.9375 L181.1719,18.9375 Q181.7813,18.9375 182.0469,19.1719 Q182.3125,19.4063 182.3125,19.7813 Q182.3125,20.1719 182.0469,20.4063 Q181.7813,20.6406 181.1719,20.6406 L179.4531,20.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="42" x="192.5" y="28.9102">IDevice</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="164.5" x2="236.5" y1="40" y2="40"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="164.5" x2="236.5" y1="48" y2="48"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="27" x="169.5" y="63.4189">Run()</text><!--MD5=[76256baee32c93fbbadf0c4cecce390a]
class IScanner--><rect fill="#FEFECE" filter="url(#fo14e3pkjft7r)" height="61.8359" id="IScanner" style="stroke: #A80036; stroke-width: 1.5;" width="82" x="139.5" y="130"/><ellipse cx="154.5" cy="146" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M155.4531,142.6406 L155.4531,149.2969 L157.1719,149.2969 Q157.7813,149.2969 158.0469,149.5313 Q158.3125,149.7656 158.3125,150.1563 Q158.3125,150.5313 158.0469,150.7656 Q157.7813,151 157.1719,151 L152.0313,151 Q151.4219,151 151.1563,150.7656 Q150.8906,150.5313 150.8906,150.1406 Q150.8906,149.7656 151.1563,149.5313 Q151.4219,149.2969 152.0313,149.2969 L153.75,149.2969 L153.75,142.6406 L152.0313,142.6406 Q151.4219,142.6406 151.1563,142.4063 Q150.8906,142.1719 150.8906,141.7813 Q150.8906,141.4063 151.1563,141.1719 Q151.4219,140.9375 152.0313,140.9375 L157.1719,140.9375 Q157.7813,140.9375 158.0469,141.1719 Q158.3125,141.4063 158.3125,141.7813 Q158.3125,142.1719 158.0469,142.4063 Q157.7813,142.6406 157.1719,142.6406 L155.4531,142.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="50" x="168.5" y="150.9102">IScanner</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="140.5" x2="220.5" y1="162" y2="162"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="140.5" x2="220.5" y1="170" y2="170"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="27" x="145.5" y="185.4189">Run()</text><!--MD5=[3fc38833abbf5d8e1b14ae79b381795e]
class IPrinter--><rect fill="#FEFECE" filter="url(#fo14e3pkjft7r)" height="61.8359" id="IPrinter" style="stroke: #A80036; stroke-width: 1.5;" width="72" x="256.5" y="130"/><ellipse cx="271.5" cy="146" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M272.4531,142.6406 L272.4531,149.2969 L274.1719,149.2969 Q274.7813,149.2969 275.0469,149.5313 Q275.3125,149.7656 275.3125,150.1563 Q275.3125,150.5313 275.0469,150.7656 Q274.7813,151 274.1719,151 L269.0313,151 Q268.4219,151 268.1563,150.7656 Q267.8906,150.5313 267.8906,150.1406 Q267.8906,149.7656 268.1563,149.5313 Q268.4219,149.2969 269.0313,149.2969 L270.75,149.2969 L270.75,142.6406 L269.0313,142.6406 Q268.4219,142.6406 268.1563,142.4063 Q267.8906,142.1719 267.8906,141.7813 Q267.8906,141.4063 268.1563,141.1719 Q268.4219,140.9375 269.0313,140.9375 L274.1719,140.9375 Q274.7813,140.9375 275.0469,141.1719 Q275.3125,141.4063 275.3125,141.7813 Q275.3125,142.1719 275.0469,142.4063 Q274.7813,142.6406 274.1719,142.6406 L272.4531,142.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="40" x="285.5" y="150.9102">IPrinter</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="257.5" x2="327.5" y1="162" y2="162"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="257.5" x2="327.5" y1="170" y2="170"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="27" x="262.5" y="185.4189">Run()</text><!--MD5=[0965fe93614fb4ebeb789aab1ae31cc5]
class Copier--><rect fill="#FEFECE" filter="url(#fo14e3pkjft7r)" height="48" id="Copier" style="stroke: #A80036; stroke-width: 1.5;" width="69" x="16" y="137"/><ellipse cx="31" cy="153" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M33.7656,148.875 Q33.9219,148.6563 34.1094,148.5469 Q34.2969,148.4375 34.5156,148.4375 Q34.8906,148.4375 35.125,148.7031 Q35.3594,148.9531 35.3594,149.5625 L35.3594,151.0156 Q35.3594,151.625 35.125,151.8906 Q34.8906,152.1563 34.5156,152.1563 Q34.1719,152.1563 33.9688,151.9531 Q33.7656,151.7656 33.6563,151.25 Q33.6094,150.8906 33.4219,150.7031 Q33.0938,150.3281 32.4844,150.1094 Q31.875,149.8906 31.25,149.8906 Q30.4844,149.8906 29.8438,150.2188 Q29.2188,150.5469 28.7188,151.2969 Q28.2344,152.0469 28.2344,153.0781 L28.2344,154.1719 Q28.2344,155.4063 29.125,156.2344 Q30.0156,157.0469 31.6094,157.0469 Q32.5469,157.0469 33.2031,156.7969 Q33.5938,156.6406 34.0156,156.2031 Q34.2813,155.9375 34.4219,155.8594 Q34.5781,155.7813 34.7813,155.7813 Q35.1094,155.7813 35.3594,156.0469 Q35.625,156.2969 35.625,156.6406 Q35.625,156.9844 35.2813,157.3906 Q34.7813,157.9688 33.9844,158.2969 Q32.9063,158.75 31.6094,158.75 Q30.0938,158.75 28.8906,158.125 Q27.9063,157.625 27.2188,156.5625 Q26.5313,155.4844 26.5313,154.2031 L26.5313,153.0469 Q26.5313,151.7188 27.1406,150.5781 Q27.7656,149.4219 28.8594,148.8125 Q29.9531,148.1875 31.1875,148.1875 Q31.9219,148.1875 32.5625,148.3594 Q33.2188,148.5156 33.7656,148.875 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="37" x="45" y="157.9102">Copier</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="17" x2="84" y1="169" y2="169"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="17" x2="84" y1="177" y2="177"/><ellipse cx="28.5" cy="39" fill="#FEFECE" filter="url(#fo14e3pkjft7r)" rx="5" ry="5" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="49" x="4" y="56.457">IScanner</text><ellipse cx="73.5" cy="39" fill="#FEFECE" filter="url(#fo14e3pkjft7r)" rx="5" ry="5" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="39" x="54" y="56.457">IPrinter</text><!--MD5=[175f95e045c1a44aed0b30df3abe0e5c]
class Program--><rect fill="#FEFECE" filter="url(#fo14e3pkjft7r)" height="61.8359" id="Program" style="stroke: #A80036; stroke-width: 1.5;" width="89" x="6" y="252"/><ellipse cx="25.05" cy="268" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M27.8156,263.875 Q27.9719,263.6563 28.1594,263.5469 Q28.3469,263.4375 28.5656,263.4375 Q28.9406,263.4375 29.175,263.7031 Q29.4094,263.9531 29.4094,264.5625 L29.4094,266.0156 Q29.4094,266.625 29.175,266.8906 Q28.9406,267.1563 28.5656,267.1563 Q28.2219,267.1563 28.0188,266.9531 Q27.8156,266.7656 27.7063,266.25 Q27.6594,265.8906 27.4719,265.7031 Q27.1438,265.3281 26.5344,265.1094 Q25.925,264.8906 25.3,264.8906 Q24.5344,264.8906 23.8938,265.2188 Q23.2688,265.5469 22.7688,266.2969 Q22.2844,267.0469 22.2844,268.0781 L22.2844,269.1719 Q22.2844,270.4063 23.175,271.2344 Q24.0656,272.0469 25.6594,272.0469 Q26.5969,272.0469 27.2531,271.7969 Q27.6438,271.6406 28.0656,271.2031 Q28.3313,270.9375 28.4719,270.8594 Q28.6281,270.7813 28.8313,270.7813 Q29.1594,270.7813 29.4094,271.0469 Q29.675,271.2969 29.675,271.6406 Q29.675,271.9844 29.3313,272.3906 Q28.8313,272.9688 28.0344,273.2969 Q26.9563,273.75 25.6594,273.75 Q24.1438,273.75 22.9406,273.125 Q21.9563,272.625 21.2688,271.5625 Q20.5813,270.4844 20.5813,269.2031 L20.5813,268.0469 Q20.5813,266.7188 21.1906,265.5781 Q21.8156,264.4219 22.9094,263.8125 Q24.0031,263.1875 25.2375,263.1875 Q25.9719,263.1875 26.6125,263.3594 Q27.2688,263.5156 27.8156,263.875 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="48" x="39.95" y="272.9102">Program</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="7" x2="94" y1="284" y2="284"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="7" x2="94" y1="292" y2="292"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="77" x="12" y="307.4189">Main() { Run(); }</text><!--MD5=[72c4b8e0914427b16b759dbbe918d548]
reverse link IDevice to IScanner--><path d="M192.105,90.373 C189.874,103.754 187.535,117.792 185.545,129.729 " fill="none" id="IDevice&lt;-IScanner" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="185.26,88.858,195.453,70.281,199.07,91.16,185.26,88.858" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[dce2785007fc877640323c6a323afcbc]
reverse link IDevice to IPrinter--><path d="M236.204,86.57 C247.314,101.062 259.269,116.655 269.292,129.729 " fill="none" id="IDevice&lt;-IPrinter" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="230.329,90.412,223.715,70.281,241.439,81.894,230.329,90.412" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[a7bb0950af10a802572792667bbf499f]
link Copierlol817 to Copier--><path d="M29.232,43.993 C31.8415,58.226 40.8219,107.21 46.2435,136.783 " fill="none" id="Copierlol817-Copier" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[fcec134684a652937c04b60d06eb4c1c]
link Copierlol821 to Copier--><path d="M72.7347,43.993 C70.0066,58.226 60.6181,107.21 54.95,136.783 " fill="none" id="Copierlol821-Copier" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[2c1e092609c587adf3b4a4b7e3b9fde7]
link Copier to Program--><path d="M50.5,185.137 C50.5,204.071 50.5,231.0004 50.5,251.6608 " fill="none" id="Copier-Program" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[52fa8db176ee4ce109377df7b195fc03]
@startuml

IDevice <|- - IScanner
IDevice <|- - IPrinter
IScanner ()- - Copier
IPrinter ()- - Copier

IDevice : Run()
IScanner : Run()
IPrinter : Run()

interface IDevice
interface IScanner
interface IPrinter

class Program
{
    {static} Main() { Run(); }
}
Program -up- Copier

@enduml

PlantUML version 1.2019.11(Sun Sep 22 12:02:15 CEST 2019)
(MIT source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.2+9
Operating System: Windows 10
Default Encoding: Cp1250
Language: pl
Country: PL
--></g></svg></p><p>Kt&#xF3;ra z metod <code>Run()</code> zostanie wywo&#x142;ana?</p>
<pre data-role="codeBlock" data-info="csharp {highlight=[6, 26]}" class="language-csharp" data-line="6,26"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Program</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name">Copier</span> xerox <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Copier</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        xerox<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//compilation error</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">IDevice</span>
<span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">&quot;Device Run&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">IScanner</span> <span class="token punctuation">:</span> <span class="token class-name">IDevice</span>
<span class="token punctuation">{</span>
    <span class="token keyword">void</span> IDevice<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">&quot;Scanner Run&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">IPrinter</span> <span class="token punctuation">:</span> <span class="token class-name">IDevice</span>
<span class="token punctuation">{</span>
    <span class="token keyword">void</span> IDevice<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">&quot;Printer Run&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Copier</span> <span class="token punctuation">:</span>
    <span class="token class-name">IScanner</span><span class="token punctuation">,</span> <span class="token comment">//compilation error</span>
    IPrinter
<span class="token punctuation">{</span>

<span class="token punctuation">}</span>
<div class="line-highlight-wrapper">




<div aria-hidden="true" class="line-highlight" data-range="6" data-start="6">
</div></div><div class="line-highlight-wrapper">
























<div aria-hidden="true" class="line-highlight" data-range="26" data-start="26">
</div></div></pre><pre data-role="codeBlock" data-info="console" class="language-console"><code>error CS1061: Element &quot;Copier&quot; nie zawiera definicji &quot;Run&quot; i nie odnaleziono dost&#x119;pnej metody rozszerzenia &quot;Run&quot;, kt&#xF3;ra przyjmuje pierwszy argument typu &quot;Copier&quot; (czy nie brakuje dyrektywy using lub odwo&#x142;ania do zestawu?).
error CS8705: Sk&#x142;adowa interfejsu &quot;IDevice.Run()&quot; nie ma najbardziej specyficznej implementacji. Ani implementacja &quot;IScanner.IDevice.Run()&quot;, ani &quot;IPrinter.IDevice.Run()&quot; nie jest najbardziej specyficzna.
</code></pre><p>W powy&#x17C;szym przyk&#x142;adzie kompilator wskazuje na 2 b&#x142;&#x119;dy:</p>
<p>Pierwszy b&#x142;&#x105;d dotyczy og&#xF3;lnej zasady - w klasie <code>Copier</code> nie przeprowadzono implementacji <code>Run()</code>. Zatem dost&#x119;p do domy&#x15B;lnych implementacji mo&#x17C;liwy jest za po&#x15B;rednictwem referencji do odpowiedniego interfejsu. Gdyby w metodzie <code>Main()</code> wykona&#x107; rzutowanie:</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp"><span class="token punctuation">(</span><span class="token punctuation">(</span>IScanner<span class="token punctuation">)</span>xerox<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span><span class="token punctuation">(</span>IPrinter<span class="token punctuation">)</span>xerox<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>b&#x142;&#x119;du kompilacji by nie by&#x142;o.</p>
<p>Ale pozosta&#x142;by drugi b&#x142;&#x105;d (zwi&#x105;zany z problemem wielodziedziczenia).</p>
<p>W dokumentacji Microsoft czytamy:</p>
<blockquote>
<p>A class implementation of an interface member should always win over a default implementation in an interface, even if it is inherited from a base class. Default implementations are always a fall-back only for when the class does not have any implementation of the member at all. <a href="https://github.com/dotnet/csharplang/blob/master/meetings/2017/LDM-2017-04-19.md#diamonds-with-classes">C# Language Design Notes for Apr 19, 2017</a>.</p>
</blockquote>
<p>W momencie uruchomienia kodu &#x15B;rodowisko .Net <strong>musi</strong> jednoznacznie wiedzie&#x107;, kt&#xF3;r&#x105; metod&#x119; ma wywo&#x142;a&#x107;.</p>
<p>Zatem - w klasie <code>Copier</code> nale&#x17C;y zaimplementowa&#x107; metod&#x119; <code>Run()</code> przes&#x142;aniaj&#x105;c&#x105; domy&#x15B;lne implementacje w interfejsach:</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp"><span class="token keyword">class</span> <span class="token class-name">Copier</span> <span class="token punctuation">:</span>
    <span class="token class-name">IScanner</span><span class="token punctuation">,</span>
    IPrinter
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">&quot;Copier run&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// Main()</span>
<span class="token class-name">Copier</span> xerox <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Copier</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
xerox<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// output: Copier run</span>
</pre><p>Mo&#x17C;na r&#xF3;wnie&#x17C; przes&#x142;oni&#x107; domy&#x15B;ln&#x105; implementacj&#x119; t&#x119; z interfejsu <code>IDevice</code>:</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp"><span class="token keyword">class</span> <span class="token class-name">Copier</span> <span class="token punctuation">:</span>
    <span class="token class-name">IScanner</span><span class="token punctuation">,</span>
    IPrinter
<span class="token punctuation">{</span>
    <span class="token keyword">void</span> IDevice<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">&quot;Copier run&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre><p>Wtedy, bez wzgl&#x119;du na typ interfejsu, na kt&#xF3;ry b&#x119;dziemy rzutowa&#x107;, uruchomi si&#x119; w&#x142;a&#x15B;nie ta nowa implementacja:</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp"><span class="token class-name">Copier</span> xerox <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Copier</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span><span class="token punctuation">(</span>IScanner<span class="token punctuation">)</span>xerox<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// output: Copier run</span>
<span class="token punctuation">(</span><span class="token punctuation">(</span>IPrinter<span class="token punctuation">)</span>xerox<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// output: Copier run</span>
</pre><p>Ostrze&#x17C;enie: Poni&#x17C;sza implementacja jest b&#x142;&#x119;dna:</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp"><span class="token keyword">class</span> <span class="token class-name">Copier</span> <span class="token punctuation">:</span>
    <span class="token class-name">IScanner</span><span class="token punctuation">,</span>
    IPrinter
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token punctuation">(</span><span class="token punctuation">(</span>IScanner<span class="token punctuation">)</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">(</span><span class="token punctuation">(</span>IPrinter<span class="token punctuation">)</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// Main()</span>
<span class="token class-name">Copier</span> xerox <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Copier</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
xerox<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// stack overflow</span>
</pre><p>Kompilacja przechodzi. <strong>Uuuuups</strong>. Po uruchomieniu otrzymujemy przepe&#x142;nienie stosu - czyli rekurencja bez zako&#x144;czenia.</p>
<p>Przyczyna:</p>
<ol>
<li>wywo&#x142;anie <code>xerox.Run()</code> prowadzi do metody <code>Run()</code> w klasie <code>Copier</code>.</li>
<li>wywo&#x142;anie <code>((IScanner)this).Run()</code> - mimo, i&#x17C; rzutujemy na interfejs, typem (dynamicznym) <code>this</code> jest <code>Copier</code>.</li>
<li>zatem ponownie wywo&#x142;ujemy metod&#x119; <code>Run()</code> z klasy <code>Copier</code>.</li>
<li>... i mamy rekurencj&#x119;.</li>
</ol>
<p>Je&#x15B;li jednak do klasy <code>Copier</code> dopiszemy jawn&#x105; implementacj&#x119; <code>Run</code> przes&#x142;aniaj&#x105;c&#x105; t&#x119; z <code>IDevice</code>, b&#x142;&#x119;du ju&#x17C; nie b&#x119;dzie:</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp"><span class="token keyword">class</span> <span class="token class-name">Copier</span> <span class="token punctuation">:</span>
    <span class="token class-name">IScanner</span><span class="token punctuation">,</span>
    IPrinter
<span class="token punctuation">{</span>
    <span class="token keyword">void</span> IDevice<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">&quot;Copier run&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token punctuation">(</span><span class="token punctuation">(</span>IScanner<span class="token punctuation">)</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">(</span><span class="token punctuation">(</span>IPrinter<span class="token punctuation">)</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// Main()</span>
<span class="token class-name">Copier</span> xerox <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Copier</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
xerox<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// output:</span>
<span class="token comment">// Copier run</span>
<span class="token comment">// Copier run</span>
</pre><p>Jednak najlepszym rozwi&#x105;zaniem jest nie u&#x17C;ywanie nazwy <code>Run()</code> w klasie <code>Copier</code> (Mo&#x17C;na zast&#x105;pi&#x107; j&#x105; np. <code>CopierRun()</code>) oraz nie tyle przes&#x142;anianie <em>explicite</em> domy&#x15B;lnych implementacji metod, ile definiowanie nowych (<code>new</code>).</p>
<pre data-role="codeBlock" data-info="csharp {highlight=[6, 17, 22]}" class="language-csharp" data-line="6,17,22"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Program</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name">Copier</span> xerox <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Copier</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        xerox<span class="token punctuation">.</span><span class="token function">CopierRun</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">IDevice</span>
<span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">&quot;Device Run&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">IScanner</span> <span class="token punctuation">:</span> <span class="token class-name">IDevice</span>
<span class="token punctuation">{</span>
    <span class="token keyword">new</span> <span class="token keyword">void</span> <span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">&quot;Scanner Run&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">IPrinter</span> <span class="token punctuation">:</span> <span class="token class-name">IDevice</span>
<span class="token punctuation">{</span>
    <span class="token keyword">new</span> <span class="token keyword">void</span> <span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">&quot;Printer Run&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Copier</span> <span class="token punctuation">:</span> <span class="token class-name">IScanner</span><span class="token punctuation">,</span> IPrinter
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">CopierRun</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token punctuation">(</span><span class="token punctuation">(</span>IScanner<span class="token punctuation">)</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">(</span><span class="token punctuation">(</span>IPrinter<span class="token punctuation">)</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<div class="line-highlight-wrapper">




<div aria-hidden="true" class="line-highlight" data-range="6" data-start="6">
</div></div><div class="line-highlight-wrapper">















<div aria-hidden="true" class="line-highlight" data-range="17" data-start="17">
</div></div><div class="line-highlight-wrapper">




















<div aria-hidden="true" class="line-highlight" data-range="22" data-start="22">
</div></div></pre><pre data-role="codeBlock" data-info="console" class="language-console"><code>Scanner Run
Printer Run
</code></pre><h3 class="mume-header" id="podsumowanie">Podsumowanie</h3>

<p>The C# syntax for an interface in .NET compiler is extended to accept the new keywords in the interfaces which are listed below. For example, you can write a private method in the interface and the code will still compile and work.</p>
<ul>
<li>A body for a method or indexer, property, or event accessor</li>
<li>Private, protected, internal, public, virtual, abstract, new, sealed, static, extern</li>
<li>Static fields</li>
<li>Static methods, properties, indexers, and events.</li>
<li>Explicit access modifiers with default access is public</li>
<li>Override modifiers</li>
</ul>
<p>Not allowed:</p>
<ul>
<li>Instance state, instance fields, instance auto-properties</li>
</ul>
<hr>
<p>This feature also enables C# to interoperate with APIs that target Android or Swift, which support similar features. Default interface methods also enable scenarios similar to a &quot;<a href="https://en.wikipedia.org/wiki/Trait_(computer_programming)">traits</a>&quot; language feature.</p>
<hr>
<p>Referencje:</p>
<ul>
<li>
<p><a href="https://docs.microsoft.com/pl-pl/dotnet/csharp/whats-new/csharp-8#default-interface-methods">What&apos;s new in C# 8.0</a></p>
</li>
<li>
<p><a href="https://docs.microsoft.com/pl-pl/dotnet/csharp/tutorials/default-interface-methods-versions">Tutorial: Update interfaces with default interface methods in C# 8.0</a></p>
</li>
<li>
<p><a href="https://dzone.com/articles/evolution-of-interface-in-history-of-java">Evolution of Interfaces in History of Java</a></p>
</li>
</ul>

      </div>
      <div class="md-sidebar-toc"><ul>
<li><a href="#interfejsy-w-c-8-nowe-rozdanie">Interfejsy w C# 8 - nowe rozdanie</a></li>
<li><a href="#c-8-domy%C5%9Blna-implementacja-sk%C5%82adnik%C3%B3w-interfejsu">C# 8 - domy&#x15B;lna implementacja sk&#x142;adnik&#xF3;w interfejsu</a>
<ul>
<li><a href="#idea">Idea</a></li>
<li><a href="#konsekwencje">Konsekwencje</a>
<ul>
<li><a href="#sk%C5%82adniki-prywatne-interfejs%C3%B3w">Sk&#x142;adniki prywatne interfejs&#xF3;w</a></li>
<li><a href="#sk%C5%82adniki-statyczne-interfejs%C3%B3w">Sk&#x142;adniki statyczne interfejs&#xF3;w</a></li>
<li><a href="#sk%C5%82adniki-publiczne-interfejs%C3%B3w">Sk&#x142;adniki publiczne interfejs&#xF3;w</a></li>
<li><a href="#hierarchie-interfejs%C3%B3w">Hierarchie interfejs&#xF3;w</a></li>
</ul>
</li>
<li><a href="#podsumowanie">Podsumowanie</a></li>
</ul>
</li>
</ul>
</div>
      <a id="sidebar-toc-btn">&#x2261;</a>
    
    
    
    
    
    
    
    
<script>

var sidebarTOCBtn = document.getElementById('sidebar-toc-btn')
sidebarTOCBtn.addEventListener('click', function(event) {
  event.stopPropagation()
  if (document.body.hasAttribute('html-show-sidebar-toc')) {
    document.body.removeAttribute('html-show-sidebar-toc')
  } else {
    document.body.setAttribute('html-show-sidebar-toc', true)
  }
})
</script>
      
  
    </body></html>